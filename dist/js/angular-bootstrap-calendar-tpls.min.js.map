{"version":3,"sources":["app.js","templates.js","filters/truncateEventTitle.js","services/moment.js","services/calendarhelper.js","directives/mwlcalendaryear.js","directives/mwlcalendarweek.js","directives/mwlcalendarmonth.js","directives/mwlcalendarday.js","directives/mwlcalendar.js"],"names":["angular","module","run","$templateCache","put","filter","string","length","boxHeight","substr","constant","window","moment","service","$filter","isISOWeekBasedOnLocale","startOf","day","isISOWeek","userValue","isDefined","self","this","getMonthNames","short","format","months","i","push","Date","getWeekDayNames","useISOWeek","weekdays","startDay","eventIsInPeriod","eventStart","eventEnd","periodStart","periodEnd","isAfter","isBefore","isSame","getYearView","events","currentDay","grid","row","j","monthIndex","startPeriod","endPeriod","add","subtract","toDate","label","shift","isToday","event","starts_at","ends_at","getMonthView","getWeekDayIndex","startOfMonth","dateOffset","numberOfDaysInMonth","endOf","date","buildRow","Array","eventsWithIds","map","index","$id","weekdayIndex","prefillMonth","clone","inMonth","postfillMonth","getWeekView","beginningOfWeek","endOfWeek","columns","weekDays","currentWeekDayIndex","getDay","weekDay","eventsSorted","span","diff","offset","daySpan","dayOffset","getDayView","dayStartHour","dayEndHour","calendarStart","calendarEnd","calendarHeight","buckets","top","height","diffStart","left","cannotFitInABucket","forEach","bucket","bucketIndex","canFitInThisBucket","bucketItem","toggleEventBreakdown","view","rowIndex","cellIndex","closeAllOpenItems","isOpened","cell","openEvents","isCellOpened","directive","$sce","$timeout","calendarHelper","templateUrl","restrict","require","scope","eventClick","eventEditClick","eventDeleteClick","editEventHtml","deleteEventHtml","autoOpen","link","element","attrs","calendarCtrl","updateView","firstRun","year","monthClicked","titleFunctions","$watch","yearIndex","handler","drillDown","month","changeView","useIsoWeek","disableDayView","week","dayClicked","highlightEvent","shouldAddClass","highlightClass","dayContainsEvent","e","type","eventLabel","timeLabel","dayViewStart","dayViewEnd","hours","days","dayCounter","control","controller","$scope","$locale","newDay","prev","next","getTitle","firstRunWatcher","unbindWatcher","locale","id","originalView","copy","unbindDestroyListener","$on"],"mappings":"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","file":"angular-bootstrap-calendar-tpls.min.js","sourcesContent":["'use strict';\r\n\r\n/**\r\n * @ngdoc overview\r\n * @name angularBootstrapCalendarApp\r\n * @description\r\n * # angularBootstrapCalendarApp\r\n *\r\n * Main module of the application.\r\n */\r\nangular\r\n  .module('mwl.calendar', [\r\n    'ui.bootstrap'\r\n  ]);\r\n","angular.module(\"mwl.calendar\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"templates/day.html\",\"<div class=\\\"cal-day-box\\\"><div class=\\\"row-fluid clearfix cal-row-head\\\"><div class=\\\"span1 col-xs-1 cal-cell\\\">{{ timeLabel || \\'Time\\' }}</div><div class=\\\"span11 col-xs-11 cal-cell\\\">{{ eventLabel || \\'Events\\' }}</div></div><div class=\\\"cal-day-panel\\\" ng-style=\\\"{height: (days.length * 60) + \\'px\\'}\\\"><div class=\\\"cal-day-panel-hour\\\"><div class=\\\"cal-day-hour\\\" ng-repeat=\\\"day in days\\\"><div class=\\\"row-fluid cal-day-hour-part\\\"><div class=\\\"span1 col-xs-1\\\"><b>{{ day.label }}</b></div><div class=\\\"span11 col-xs-11\\\"></div></div><div class=\\\"row-fluid cal-day-hour-part\\\"><div class=\\\"span1 col-xs-1\\\"></div><div class=\\\"span11 col-xs-11\\\"></div></div></div></div><div class=\\\"pull-left day-event day-highlight dh-event-{{ event.type }}\\\" ng-repeat=\\\"event in view track by $index\\\" ng-style=\\\"{top: event.top + \\'px\\', left: event.left + 60 + \\'px\\', height: event.height + \\'px\\'}\\\"><!--<span class=\\\"cal-hours\\\">{{ event.starts_at | date:\\'d MMM HH:mm\\' }} - {{ event.ends_at | date:\\'d MMM HH:mm\\' }}<br></span>--><a href=\\\"javascript:;\\\" class=\\\"event-item\\\" ng-click=\\\"eventClick({$event: event})\\\"><span>{{ event.title | truncateEventTitle:20:event.height }}</span></a></div></div></div>\");\n$templateCache.put(\"templates/main.html\",\"<div class=\\\"cal-context\\\" style=\\\"width: 100%;\\\"><div class=\\\"alert alert-danger\\\" ng-if=\\\"!view\\\">The value passed to calendar-view is not set</div><mwl-calendar-year calendar-events=\\\"events\\\" calendar-current-day=\\\"currentDay\\\" calendar-event-click=\\\"eventClick\\\" calendar-edit-event-click=\\\"eventEditClick\\\" calendar-delete-event-click=\\\"eventDeleteClick\\\" calendar-edit-event-html=\\\"editEventHtml\\\" calendar-delete-event-html=\\\"deleteEventHtml\\\" calendar-auto-open=\\\"autoOpen\\\" ng-if=\\\"view == \\'year\\'\\\"></mwl-calendar-year><mwl-calendar-month calendar-events=\\\"events\\\" calendar-current-day=\\\"currentDay\\\" calendar-event-click=\\\"eventClick\\\" calendar-edit-event-click=\\\"eventEditClick\\\" calendar-delete-event-click=\\\"eventDeleteClick\\\" calendar-edit-event-html=\\\"editEventHtml\\\" calendar-delete-event-html=\\\"deleteEventHtml\\\" calendar-auto-open=\\\"autoOpen\\\" calendar-use-iso-week=\\\"useIsoWeek\\\" disable-day-view=\\\"disableDayView\\\" ng-if=\\\"view == \\'month\\'\\\"></mwl-calendar-month><mwl-calendar-week calendar-events=\\\"events\\\" calendar-current-day=\\\"currentDay\\\" calendar-event-click=\\\"eventClick\\\" calendar-use-iso-week=\\\"useIsoWeek\\\" disable-day-view=\\\"disableDayView\\\" ng-if=\\\"view == \\'week\\'\\\"></mwl-calendar-week><mwl-calendar-day calendar-events=\\\"events\\\" calendar-current-day=\\\"currentDay\\\" calendar-event-click=\\\"eventClick\\\" calendar-event-label=\\\"{{ eventLabel }}\\\" calendar-time-label=\\\"{{ timeLabel }}\\\" calendar-day-view-start=\\\"{{ dayViewStart }}\\\" calendar-day-view-end=\\\"{{ dayViewEnd }}\\\" ng-if=\\\"view == \\'day\\'\\\"></mwl-calendar-day></div>\");\n$templateCache.put(\"templates/month.html\",\"<div class=\\\"cal-row-fluid cal-row-head\\\"><div class=\\\"cal-cell1\\\" ng-repeat=\\\"day in weekDays\\\">{{ day }}</div></div><div class=\\\"cal-month-box\\\"><div ng-repeat=\\\"week in view track by $index\\\"><div class=\\\"cal-row-fluid cal-before-eventlist\\\"><div class=\\\"cal-cell1 cal-cell {{ day.highlightClass }}\\\" ng-repeat=\\\"day in week track by $index\\\" ng-click=\\\"dayClicked($parent.$index, $index)\\\" ng-class=\\\"{pointer: day.events.length > 0}\\\"><div class=\\\"cal-month-day\\\" ng-class=\\\"{\\'cal-day-outmonth\\': !day.inMonth, \\'cal-day-inmonth\\': day.inMonth, \\'cal-day-weekend\\': $index == 5 || $index == 6, \\'cal-day-today\\': day.isToday}\\\"><small class=\\\"cal-events-num badge badge-important pull-left\\\" ng-show=\\\"day.events.length > 0\\\">{{ day.events.length }}</small> <span class=\\\"pull-right\\\" data-cal-date=\\\"\\\" ng-click=\\\"drillDown(day.label)\\\">{{ day.label }}</span><div class=\\\"cal-day-tick\\\" ng-show=\\\"day.isOpened\\\"><i class=\\\"fa fa-chevron-up\\\"></i></div><div class=\\\"events-list\\\" ng-show=\\\"day.events.length > 0\\\"><a href=\\\"javascript:;\\\" ng-click=\\\"eventClick({$event: event})\\\" ng-repeat=\\\"event in day.events track by $index\\\" class=\\\"pull-left event event-{{ event.type }}\\\" ng-mouseenter=\\\"highlightEvent(event, true)\\\" ng-mouseleave=\\\"highlightEvent(event, false)\\\" tooltip-append-to-body=\\\"true\\\" tooltip=\\\"{{ event.title }}\\\"><i class=\\\"fa\\\" ng-class=\\\"event.icon_name\\\"></i></a></div></div></div></div><div class=\\\"cal-slide-box\\\" collapse=\\\"!week.isOpened\\\"><div class=\\\"cal-slide-content cal-event-list\\\"><ul class=\\\"unstyled list-unstyled\\\"><li ng-repeat=\\\"event in openEvents track by $index\\\"><span class=\\\"pull-left event event-{{ event.type }}\\\"></span> &nbsp; <a href=\\\"javascript:;\\\" class=\\\"event-item\\\" ng-click=\\\"eventClick({$event: event})\\\" ng-bind-html=\\\"event.title\\\"></a> <a href=\\\"javascript:;\\\" class=\\\"event-item-edit\\\" ng-if=\\\"editEventHtml && event.editable !== false\\\" ng-bind-html=\\\"$sce.trustAsHtml(editEventHtml)\\\" ng-click=\\\"eventEditClick({$event: event})\\\"></a> <a href=\\\"javascript:;\\\" class=\\\"event-item-delete\\\" ng-if=\\\"deleteEventHtml && event.deletable !== false\\\" ng-bind-html=\\\"$sce.trustAsHtml(deleteEventHtml)\\\" ng-click=\\\"eventDeleteClick({$event: event})\\\"></a></li></ul></div></div></div></div>\");\n$templateCache.put(\"templates/week.html\",\"<div class=\\\"cal-week-box\\\"><div class=\\\"cal-row-fluid cal-row-head text-center\\\"><div class=\\\"cal-cell1\\\" ng-repeat=\\\"column in view.columns track by $index\\\" ng-class=\\\"{\\'cal-day-weekend\\': $index > 4, \\'cal-day-today\\': column.isToday}\\\">{{ column.weekDay }}<br><small><span data-cal-date=\\\"\\\" ng-click=\\\"drillDown(column.day)\\\" class=\\\"pointer\\\">{{ column.date }}</span></small></div></div><div class=\\\"cal-row-fluid\\\" ng-repeat=\\\"event in view.events track by $index\\\"><div class=\\\"cal-cell{{ event.daySpan }} cal-offset{{ event.dayOffset }} day-highlight dh-event-{{ event.type }}\\\" data-event-class=\\\"\\\"><a href=\\\"javascript:;\\\" ng-click=\\\"eventClick({$event: event})\\\" class=\\\"cal-event-week\\\" ng-bind-html=\\\"event.title\\\"></a></div></div></div>\");\n$templateCache.put(\"templates/year.html\",\"<div class=\\\"cal-year-box\\\"><div ng-repeat=\\\"year in view track by $index\\\"><div class=\\\"row cal-before-eventlist\\\"><div class=\\\"span3 col-md-3 col-xs-6 cal-cell\\\" ng-repeat=\\\"month in year track by $index\\\" ng-click=\\\"monthClicked($parent.$index, $index)\\\" ng-class=\\\"{pointer: month.events.length > 0, \\'cal-day-today\\': month.isToday}\\\"><span class=\\\"pull-right\\\" data-cal-date=\\\"\\\" ng-click=\\\"drillDown(month.monthIndex)\\\">{{ month.label }}</span> <small class=\\\"cal-events-num badge badge-important pull-left\\\" ng-show=\\\"month.events.length > 0\\\">{{ month.events.length }}</small><div class=\\\"cal-day-tick\\\" ng-show=\\\"month.isOpened\\\"><i class=\\\"glyphicon glyphicon-chevron-up\\\"></i> <i class=\\\"fa fa-chevron-up\\\"></i></div></div></div><div class=\\\"cal-slide-box\\\" collapse=\\\"!year.isOpened\\\"><span class=\\\"cal-slide-tick\\\"></span><div class=\\\"cal-slide-content\\\"><ul class=\\\"unstyled list-unstyled\\\"><li ng-repeat=\\\"event in openEvents track by $index\\\"><span class=\\\"pull-left event\\\" ng-class=\\\"\\'event-\\' + event.type\\\"></span> &nbsp; <a href=\\\"javascript:;\\\" class=\\\"event-item\\\" ng-click=\\\"eventClick({$event: event})\\\">{{ event.title }}</a> <a href=\\\"javascript:;\\\" class=\\\"event-item-edit\\\" ng-if=\\\"editEventHtml && event.editable !== false\\\" ng-bind-html=\\\"$sce.trustAsHtml(editEventHtml)\\\" ng-click=\\\"eventEditClick({$event: event})\\\"></a> <a href=\\\"javascript:;\\\" class=\\\"event-item-delete\\\" ng-if=\\\"deleteEventHtml && event.deletable !== false\\\" ng-bind-html=\\\"$sce.trustAsHtml(deleteEventHtml)\\\" ng-click=\\\"eventDeleteClick({$event: event})\\\"></a></li></ul></div></div></div></div>\");}]);","'use strict';\r\n\r\n\r\nangular.module('mwl.calendar')\r\n  .filter('truncateEventTitle', function() {\r\n\r\n    return function(string, length, boxHeight) {\r\n      if (!string) return '';\r\n\r\n      //Only truncate if if actually needs truncating\r\n      if (string.length >= length && string.length / 20 > boxHeight / 30) {\r\n        return string.substr(0, length) + '...';\r\n      } else {\r\n        return string;\r\n      }\r\n    };\r\n\r\n  });\r\n","'use strict';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name angularBootstrapCalendarApp.moment\r\n * @description\r\n * # moment\r\n * Constant in the angularBootstrapCalendarApp.\r\n */\r\nangular.module('mwl.calendar')\r\n  .constant('moment', window.moment);\r\n","'use strict';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name angularBootstrapCalendarApp.calendarHelper\r\n * @description\r\n * # calendarHelper\r\n * Service in the angularBootstrapCalendarApp.\r\n */\r\nangular.module('mwl.calendar')\r\n  .service('calendarHelper', function calendarHelper($filter, moment) {\r\n\r\n      var self = this;\r\n\r\n      function isISOWeekBasedOnLocale() {\r\n          return moment().startOf('week').day() === 1;\r\n      }\r\n\r\n      function isISOWeek(userValue) {\r\n          //If a manual override has been set in the directive, use that\r\n          if (angular.isDefined(userValue)) return userValue;\r\n          //Otherwise fallback to the locale\r\n          return isISOWeekBasedOnLocale();\r\n      }\r\n\r\n      this.getMonthNames = function (short) {\r\n\r\n          var format = short ? 'MMM' : 'MMMM';\r\n\r\n          var months = [];\r\n          for (var i = 0; i <= 11; i++) {\r\n              months.push(moment(new Date(2014, i)).format(format));\r\n          }\r\n\r\n          return months;\r\n\r\n      };\r\n\r\n      this.getWeekDayNames = function (short, useISOWeek) {\r\n\r\n          var format = short ? 'ddd' : 'dddd';\r\n\r\n          var weekdays = [];\r\n          var startDay = isISOWeek(useISOWeek) ? 22 : 21;\r\n          for (var i = 0; i <= 6; i++) {\r\n              weekdays.push(moment(new Date(2014, 8, startDay + i)).format(format));\r\n          }\r\n\r\n          return weekdays;\r\n\r\n      };\r\n\r\n      this.eventIsInPeriod = function (eventStart, eventEnd, periodStart, periodEnd) {\r\n\r\n          return (\r\n              moment(eventStart).isAfter(moment(periodStart)) &&\r\n              moment(eventStart).isBefore(moment(periodEnd))\r\n            ) || (\r\n              moment(eventEnd).isAfter(moment(periodStart)) &&\r\n              moment(eventEnd).isBefore(moment(periodEnd))\r\n            ) || (\r\n              moment(eventStart).isBefore(moment(periodStart)) &&\r\n              moment(eventEnd).isAfter(moment(periodEnd))\r\n            ) || (\r\n              moment(eventStart).isSame(moment(periodStart))\r\n            ) || (\r\n              moment(eventEnd).isSame(moment(periodEnd))\r\n          );\r\n\r\n      };\r\n\r\n      this.getYearView = function (events, currentDay) {\r\n\r\n          var grid = [];\r\n          var months = self.getMonthNames();\r\n\r\n          for (var i = 0; i < 3; i++) {\r\n              var row = [];\r\n              for (var j = 0; j < 4; j++) {\r\n                  var monthIndex = 12 - months.length;\r\n                  var startPeriod = new Date(moment(currentDay).format('YYYY'), monthIndex, 1);\r\n                  var endPeriod = moment(startPeriod).add(1, 'month').subtract(1, 'second').toDate();\r\n\r\n                  row.push({\r\n                      label: months.shift(),\r\n                      monthIndex: monthIndex,\r\n                      isToday: moment(startPeriod).startOf('month').isSame(moment().startOf('month')),\r\n                      events: events.filter(function (event) {\r\n                          return self.eventIsInPeriod(event.starts_at, event.ends_at, startPeriod, endPeriod);\r\n                      })\r\n                  });\r\n              }\r\n              grid.push(row);\r\n          }\r\n\r\n          return grid;\r\n\r\n      };\r\n\r\n      this.getMonthView = function (events, currentDay, useISOWeek) {\r\n\r\n          var dateOffset = isISOWeek(useISOWeek) ? 1 : 0;\r\n\r\n          function getWeekDayIndex() {\r\n              var day = startOfMonth.day() - dateOffset;\r\n              if (day < 0) day = 6;\r\n              return day;\r\n          }\r\n\r\n          var startOfMonth = moment(currentDay).startOf('month');\r\n          var numberOfDaysInMonth = moment(currentDay).endOf('month').date();\r\n\r\n          var grid = [];\r\n          var buildRow = new Array(7);\r\n          var eventsWithIds = events.map(function (event, index) {\r\n              event.$id = index;\r\n              return event;\r\n          });\r\n\r\n          for (var i = 1; i <= numberOfDaysInMonth; i++) {\r\n\r\n              if (i == 1) {\r\n                  var weekdayIndex = getWeekDayIndex(startOfMonth);\r\n                  var prefillMonth = startOfMonth.clone();\r\n                  while (weekdayIndex > 0) {\r\n                      weekdayIndex--;\r\n                      prefillMonth = prefillMonth.subtract(1, 'day');\r\n                      buildRow[weekdayIndex] = {\r\n                          label: prefillMonth.date(),\r\n                          date: prefillMonth.clone(),\r\n                          inMonth: false,\r\n                          events: []\r\n                      };\r\n                  }\r\n              }\r\n\r\n              buildRow[getWeekDayIndex(startOfMonth)] = {\r\n                  label: startOfMonth.date(),\r\n                  inMonth: true,\r\n                  isToday: moment().startOf('day').isSame(startOfMonth),\r\n                  date: startOfMonth.clone(),\r\n                  events: eventsWithIds.filter(function (event) {\r\n                      return self.eventIsInPeriod(event.starts_at, event.ends_at, startOfMonth.clone().startOf('day'), startOfMonth.clone().endOf('day'));\r\n                  })\r\n              };\r\n\r\n              if (i == numberOfDaysInMonth) {\r\n                  var weekdayIndex = getWeekDayIndex(startOfMonth);\r\n                  var postfillMonth = startOfMonth.clone();\r\n                  while (weekdayIndex < 6) {\r\n                      weekdayIndex++;\r\n                      postfillMonth = postfillMonth.add(1, 'day');\r\n                      buildRow[weekdayIndex] = {\r\n                          label: postfillMonth.date(),\r\n                          date: postfillMonth.clone(),\r\n                          inMonth: false,\r\n                          events: []\r\n                      };\r\n                  }\r\n              }\r\n\r\n              if (getWeekDayIndex(startOfMonth) === 6 || i == numberOfDaysInMonth) {\r\n                  grid.push(buildRow);\r\n                  buildRow = new Array(7);\r\n              }\r\n\r\n              startOfMonth = startOfMonth.add(1, 'day');\r\n\r\n          }\r\n\r\n          return grid;\r\n\r\n      };\r\n\r\n      this.getWeekView = function (events, currentDay, useISOWeek) {\r\n\r\n          var dateOffset = isISOWeek(useISOWeek) ? 1 : 0;\r\n          var columns = new Array(7);\r\n          var weekDays = self.getWeekDayNames(false, useISOWeek);\r\n          var currentWeekDayIndex = currentDay.getDay();\r\n          var beginningOfWeek, endOfWeek;\r\n\r\n          for (var i = currentWeekDayIndex; i >= 0; i--) {\r\n              var date = moment(currentDay).subtract(currentWeekDayIndex - i, 'days').add(dateOffset, 'day').toDate();\r\n              columns[i] = {\r\n                  weekDay: weekDays[i],\r\n                  day: moment(date).format('D'),\r\n                  date: moment(date).format('D MMM'),\r\n                  isToday: moment(date).startOf('day').isSame(moment().startOf('day'))\r\n              };\r\n              if (i == 0) {\r\n                  beginningOfWeek = date;\r\n              } else if (i == 6) {\r\n                  endOfWeek = date;\r\n              }\r\n          }\r\n\r\n          for (var i = currentWeekDayIndex + 1; i < 7; i++) {\r\n              var date = moment(currentDay).add(i - currentWeekDayIndex, 'days').add(dateOffset, 'day').toDate();\r\n              columns[i] = {\r\n                  weekDay: weekDays[i],\r\n                  day: moment(date).format('D'),\r\n                  date: moment(date).format('D MMM'),\r\n                  isToday: moment(date).startOf('day').isSame(moment().startOf('day'))\r\n              };\r\n              if (i == 0) {\r\n                  beginningOfWeek = date;\r\n              } else if (i == 6) {\r\n                  endOfWeek = date;\r\n              }\r\n          }\r\n\r\n          endOfWeek = moment(endOfWeek).endOf('day').toDate();\r\n          beginningOfWeek = moment(beginningOfWeek).startOf('day').toDate();\r\n\r\n          var eventsSorted = events.filter(function (event) {\r\n              return self.eventIsInPeriod(event.starts_at, event.ends_at, beginningOfWeek, endOfWeek);\r\n          }).map(function (event) {\r\n              var span = moment(event.ends_at).startOf('day').diff(moment(event.starts_at).startOf('day'), 'days') + 1;\r\n              if (span >= 7) {\r\n                  span = 7;\r\n                  if (moment(event.ends_at).startOf('day').diff(moment(endOfWeek).startOf('day'), 'days') < 0) {\r\n                      span += moment(event.ends_at).startOf('day').diff(moment(endOfWeek).startOf('day'), 'days') + dateOffset;\r\n                  }\r\n              }\r\n\r\n              var offset = moment(event.starts_at).startOf('day').diff(moment(beginningOfWeek).startOf('day'), 'days');\r\n              if (offset < 0) offset = 0;\r\n              if (offset > 6) offset = 6;\r\n\r\n              if (span - offset > 0) {\r\n                  span -= offset;\r\n              }\r\n\r\n              event.daySpan = span;\r\n              event.dayOffset = offset;\r\n              return event;\r\n          });\r\n\r\n          return { columns: columns, events: eventsSorted };\r\n\r\n      };\r\n\r\n      this.getDayView = function (events, currentDay, dayStartHour, dayEndHour) {\r\n\r\n          var calendarStart = moment(currentDay).startOf('day').add(dayStartHour, 'hours');\r\n          var calendarEnd = moment(currentDay).startOf('day').add(dayEndHour, 'hours');\r\n          var calendarHeight = (dayEndHour - dayStartHour + 1) * 60;\r\n          var buckets = [];\r\n\r\n          return events.filter(function (event) {\r\n              return self.eventIsInPeriod(event.starts_at, event.ends_at, moment(currentDay).startOf('day').toDate(), moment(currentDay).endOf('day').toDate());\r\n          }).map(function (event) {\r\n              if (moment(event.starts_at).isBefore(calendarStart)) {\r\n                  event.top = 0;\r\n              } else {\r\n                  event.top = moment(event.starts_at).startOf('minute').diff(calendarStart.startOf('minute'), 'minutes') - 2;\r\n              }\r\n\r\n              if (moment(event.ends_at).isAfter(calendarEnd)) {\r\n                  event.height = calendarHeight - event.top;\r\n              } else {\r\n                  var diffStart = event.starts_at;\r\n                  if (moment(event.starts_at).isBefore(calendarStart)) {\r\n                      diffStart = calendarStart.toDate();\r\n                  }\r\n                  event.height = moment(event.ends_at).diff(diffStart, 'minutes');\r\n              }\r\n\r\n              if (event.top - event.height > calendarHeight) {\r\n                  event.height = 0;\r\n              }\r\n\r\n              event.left = 0;\r\n\r\n              return event;\r\n          }).filter(function (event) {\r\n              return event.height > 0;\r\n          }).map(function (event) {\r\n\r\n              var cannotFitInABucket = true;\r\n              buckets.forEach(function (bucket, bucketIndex) {\r\n                  var canFitInThisBucket = true;\r\n\r\n                  bucket.forEach(function (bucketItem) {\r\n                      if (self.eventIsInPeriod(event.starts_at, event.ends_at, bucketItem.starts_at, bucketItem.ends_at) || self.eventIsInPeriod(bucketItem.starts_at, bucketItem.ends_at, event.starts_at, event.ends_at)) {\r\n                          canFitInThisBucket = false;\r\n                      }\r\n                  });\r\n\r\n                  if (canFitInThisBucket && cannotFitInABucket) {\r\n                      cannotFitInABucket = false;\r\n                      event.left = bucketIndex * 150;\r\n                      buckets[bucketIndex].push(event);\r\n                  }\r\n\r\n              });\r\n\r\n              if (cannotFitInABucket) {\r\n                  event.left = buckets.length * 150;\r\n                  buckets.push([event]);\r\n              }\r\n\r\n              return event;\r\n\r\n          });\r\n\r\n      };\r\n\r\n      this.toggleEventBreakdown = function (view, rowIndex, cellIndex) {\r\n\r\n          var openEvents = [];\r\n\r\n          function closeAllOpenItems() {\r\n              view = view.map(function (row) {\r\n                  row.isOpened = false;\r\n                  return row.map(function (cell) {\r\n                      cell.isOpened = false;\r\n                      return cell;\r\n                  });\r\n              });\r\n          }\r\n\r\n          if (view[rowIndex][cellIndex].events.length > 0) {\r\n\r\n              var isCellOpened = view[rowIndex][cellIndex].isOpened;\r\n\r\n              closeAllOpenItems();\r\n\r\n              view[rowIndex][cellIndex].isOpened = !isCellOpened;\r\n              view[rowIndex].isOpened = !isCellOpened;\r\n              openEvents = view[rowIndex][cellIndex].events;\r\n          } else {\r\n              closeAllOpenItems();\r\n          }\r\n\r\n          return { view: view, openEvents: openEvents };\r\n\r\n      };\r\n\r\n  });\r\n","'use strict';\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name angularBootstrapCalendarApp.directive:mwlCalendarYear\r\n * @description\r\n * # mwlCalendarYear\r\n */\r\nangular.module('mwl.calendar')\r\n  .directive('mwlCalendarYear', function($sce, $timeout, calendarHelper, moment) {\r\n    return {\r\n      templateUrl: 'templates/year.html',\r\n      restrict: 'EA',\r\n      require: '^mwlCalendar',\r\n      scope: {\r\n        events: '=calendarEvents',\r\n        currentDay: '=calendarCurrentDay',\r\n        eventClick: '=calendarEventClick',\r\n        eventEditClick: '=calendarEditEventClick',\r\n        eventDeleteClick: '=calendarDeleteEventClick',\r\n        editEventHtml: '=calendarEditEventHtml',\r\n        deleteEventHtml: '=calendarDeleteEventHtml',\r\n        autoOpen: '=calendarAutoOpen'\r\n      },\r\n      link: function postLink(scope, element, attrs, calendarCtrl) {\r\n\r\n        var firstRun = false;\r\n\r\n        scope.$sce = $sce;\r\n\r\n        calendarCtrl.titleFunctions.year = function(currentDay) {\r\n          return moment(currentDay).format('YYYY');\r\n        };\r\n\r\n        function updateView() {\r\n          scope.view = calendarHelper.getYearView(scope.events, scope.currentDay);\r\n\r\n          //Auto open the calendar to the current day if set\r\n          if (scope.autoOpen && !firstRun) {\r\n            scope.view.forEach(function(row, rowIndex) {\r\n              row.forEach(function(year, cellIndex) {\r\n                if (year.label == moment(scope.currentDay).format('MMMM')) {\r\n                  scope.monthClicked(rowIndex, cellIndex);\r\n                  $timeout(function() {\r\n                    firstRun = false;\r\n                  });\r\n                }\r\n              });\r\n            });\r\n          }\r\n        }\r\n\r\n        scope.$watch('currentDay', updateView);\r\n        scope.$watch('events', updateView, true);\r\n\r\n        scope.monthClicked = function(yearIndex, monthIndex) {\r\n\r\n          var handler = calendarHelper.toggleEventBreakdown(scope.view, yearIndex, monthIndex);\r\n          scope.view = handler.view;\r\n          scope.openEvents = handler.openEvents;\r\n\r\n        };\r\n\r\n        scope.drillDown = function(month) {\r\n          calendarCtrl.changeView('month', moment(scope.currentDay).clone().month(month).toDate());\r\n        };\r\n\r\n      }\r\n    };\r\n  });\r\n","'use strict';\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name angularBootstrapCalendarApp.directive:mwlCalendarWeek\r\n * @description\r\n * # mwlCalendarWeek\r\n */\r\nangular.module('mwl.calendar')\r\n  .directive('mwlCalendarWeek', function (moment, calendarHelper) {\r\n      return {\r\n          templateUrl: 'templates/week.html',\r\n          restrict: 'EA',\r\n          require: '^mwlCalendar',\r\n          scope: {\r\n              events: '=calendarEvents',\r\n              currentDay: '=calendarCurrentDay',\r\n              eventClick: '=calendarEventClick',\r\n              useIsoWeek: '=calendarUseIsoWeek',\r\n              disableDayView: '=disableDayView'\r\n          },\r\n          link: function postLink(scope, element, attrs, calendarCtrl) {\r\n\r\n              calendarCtrl.titleFunctions.week = function (currentDay) {\r\n                  return 'Week ' + moment(currentDay).week() + ' of ' + moment(currentDay).format('YYYY');\r\n              };\r\n\r\n              function updateView() {\r\n                  scope.view = calendarHelper.getWeekView(scope.events, scope.currentDay, scope.useIsoWeek);\r\n              }\r\n\r\n              scope.drillDown = function (day) {\r\n                  if (!scope.disableDayView) {\r\n                      calendarCtrl.changeView('day', moment(scope.currentDay).clone().date(day).toDate());\r\n                  }\r\n              };\r\n\r\n              scope.$watch('currentDay', updateView);\r\n              scope.$watch('events', updateView, true);\r\n\r\n          }\r\n      };\r\n  });\r\n","'use strict';\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name angularBootstrapCalendarApp.directive:mwlCalendarMonth\r\n * @description\r\n * # mwlCalendarMonth\r\n */\r\nangular.module('mwl.calendar')\r\n  .directive('mwlCalendarMonth', function ($sce, $timeout, $filter, moment, calendarHelper) {\r\n      return {\r\n          templateUrl: 'templates/month.html',\r\n          restrict: 'EA',\r\n          require: '^mwlCalendar',\r\n          scope: {\r\n              events: '=calendarEvents',\r\n              currentDay: '=calendarCurrentDay',\r\n              eventClick: '=calendarEventClick',\r\n              eventEditClick: '=calendarEditEventClick',\r\n              eventDeleteClick: '=calendarDeleteEventClick',\r\n              editEventHtml: '=calendarEditEventHtml',\r\n              deleteEventHtml: '=calendarDeleteEventHtml',\r\n              autoOpen: '=calendarAutoOpen',\r\n              useIsoWeek: '=calendarUseIsoWeek',\r\n              disableDayView: '=disableDayView'\r\n          },\r\n          link: function postLink(scope, element, attrs, calendarCtrl) {\r\n\r\n              var firstRun = false;\r\n\r\n              scope.$sce = $sce;\r\n\r\n              calendarCtrl.titleFunctions.month = function (currentDay) {\r\n                  return $filter('date')(currentDay, 'MMMM yyyy');\r\n              };\r\n\r\n              function updateView() {\r\n                  scope.view = calendarHelper.getMonthView(scope.events, scope.currentDay, scope.useIsoWeek);\r\n\r\n                  //Auto open the calendar to the current day if set\r\n                  if (scope.autoOpen && !firstRun) {\r\n                      scope.view.forEach(function (week, rowIndex) {\r\n                          week.forEach(function (day, cellIndex) {\r\n                              if (day.inMonth && moment(scope.currentDay).startOf('day').isSame(day.date.startOf('day'))) {\r\n                                  scope.dayClicked(rowIndex, cellIndex);\r\n                                  $timeout(function () {\r\n                                      firstRun = false;\r\n                                  });\r\n                              }\r\n                          });\r\n                      });\r\n                  }\r\n\r\n              }\r\n\r\n              scope.$watch('currentDay', updateView);\r\n              scope.$watch('events', updateView, true);\r\n\r\n              scope.weekDays = calendarHelper.getWeekDayNames(false, scope.useIsoWeek);\r\n\r\n              scope.dayClicked = function (rowIndex, cellIndex) {\r\n\r\n                  var handler = calendarHelper.toggleEventBreakdown(scope.view, rowIndex, cellIndex);\r\n                  scope.view = handler.view;\r\n                  scope.openEvents = handler.openEvents;\r\n\r\n              };\r\n\r\n              scope.drillDown = function (day) {\r\n                  if (!scope.disableDayView) {\r\n                      calendarCtrl.changeView('day', moment(scope.currentDay).clone().date(day).toDate());\r\n                  }\r\n              };\r\n\r\n              scope.highlightEvent = function (event, shouldAddClass) {\r\n\r\n                  scope.view = scope.view.map(function (week) {\r\n\r\n                      week.isOpened = false;\r\n\r\n                      return week.map(function (day) {\r\n\r\n                          delete day.highlightClass;\r\n                          day.isOpened = false;\r\n\r\n                          if (shouldAddClass) {\r\n                              var dayContainsEvent = day.events.filter(function (e) {\r\n                                  return e.$id == event.$id;\r\n                              }).length > 0;\r\n\r\n                              if (dayContainsEvent) {\r\n                                  day.highlightClass = 'day-highlight dh-event-' + event.type;\r\n                              }\r\n                          }\r\n\r\n                          return day;\r\n\r\n                      });\r\n\r\n                  });\r\n\r\n              };\r\n\r\n          }\r\n      };\r\n  });\r\n","'use strict';\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name angularBootstrapCalendarApp.directive:mwlCalendarDay\r\n * @description\r\n * # mwlCalendarDay\r\n */\r\nangular.module('mwl.calendar')\r\n  .directive('mwlCalendarDay', function($filter, moment, calendarHelper) {\r\n    return {\r\n      templateUrl: 'templates/day.html',\r\n      restrict: 'EA',\r\n      require: '^mwlCalendar',\r\n      scope: {\r\n        events: '=calendarEvents',\r\n        currentDay: '=calendarCurrentDay',\r\n        eventClick: '=calendarEventClick',\r\n        eventLabel: '@calendarEventLabel',\r\n        timeLabel: '@calendarTimeLabel',\r\n        dayViewStart:'@calendarDayViewStart',\r\n        dayViewEnd:'@calendarDayViewEnd'\r\n      },\r\n      link: function postLink(scope, element, attrs, calendarCtrl) {\r\n\r\n        var dayViewStart = moment(scope.dayViewStart || '00:00', 'HH:mm');\r\n        var dayViewEnd = moment(scope.dayViewEnd || '23:00', 'HH:mm');\r\n\r\n        scope.days = [];\r\n        var dayCounter = moment(dayViewStart);\r\n        for (var i = 0; i <= dayViewEnd.diff(dayViewStart, 'hours'); i++) {\r\n          scope.days.push({\r\n            label: dayCounter.format('ha')\r\n          });\r\n          dayCounter.add(1, 'hour');\r\n        }\r\n\r\n        calendarCtrl.titleFunctions.day = function(currentDay) {\r\n          return $filter('date')(currentDay, 'EEEE d MMMM, yyyy');\r\n        };\r\n\r\n        function updateView() {\r\n          scope.view = calendarHelper.getDayView(scope.events, scope.currentDay, dayViewStart.hours(), dayViewEnd.hours());\r\n        }\r\n\r\n        scope.$watch('currentDay', updateView);\r\n        scope.$watch('events', updateView, true);\r\n\r\n      }\r\n    };\r\n  });\r\n","'use strict';\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name angularBootstrapCalendarApp.directive:mwlCalendar\r\n * @description\r\n * # mwlCalendar\r\n */\r\nangular.module('mwl.calendar')\r\n  .directive('mwlCalendar', function () {\r\n      return {\r\n          templateUrl: 'templates/main.html',\r\n          restrict: 'EA',\r\n          scope: {\r\n              events: '=calendarEvents',\r\n              view: '=calendarView',\r\n              currentDay: '=calendarCurrentDay',\r\n              control: '=calendarControl',\r\n              eventClick: '&calendarEventClick',\r\n              eventEditClick: '&calendarEditEventClick',\r\n              eventDeleteClick: '&calendarDeleteEventClick',\r\n              editEventHtml: '=calendarEditEventHtml',\r\n              deleteEventHtml: '=calendarDeleteEventHtml',\r\n              autoOpen: '=calendarAutoOpen',\r\n              useIsoWeek: '=calendarUseIsoWeek',\r\n              eventLabel: '@calendarEventLabel',\r\n              timeLabel: '@calendarTimeLabel',\r\n              dayViewStart: '@calendarDayViewStart',\r\n              dayViewEnd: '@calendarDayViewEnd',\r\n              disableDayView: '=disableDayView'\r\n          },\r\n          controller: function ($scope, $timeout, $locale, moment) {\r\n\r\n              var self = this;\r\n\r\n              this.titleFunctions = {};\r\n\r\n              this.changeView = function (view, newDay) {\r\n                  $scope.view = view;\r\n                  $scope.currentDay = newDay;\r\n              };\r\n\r\n              $scope.control = $scope.control || {};\r\n\r\n              $scope.control.prev = function () {\r\n                  $scope.currentDay = moment($scope.currentDay).subtract(1, $scope.view).toDate();\r\n              };\r\n\r\n              $scope.control.next = function () {\r\n                  $scope.currentDay = moment($scope.currentDay).add(1, $scope.view).toDate();\r\n              };\r\n\r\n              $scope.control.getTitle = function () {\r\n                  if (!self.titleFunctions[$scope.view]) {\r\n                      return '';\r\n                  }\r\n                  return self.titleFunctions[$scope.view]($scope.currentDay);\r\n              };\r\n\r\n              //Auto update the calendar when the locale changes\r\n              var firstRunWatcher = true;\r\n              var unbindWatcher = $scope.$watch(function () {\r\n                  return moment.locale() + $locale.id;\r\n              }, function () {\r\n                  if (firstRunWatcher) { //dont run the first time the calendar is initialised\r\n                      firstRunWatcher = false;\r\n                      return;\r\n                  }\r\n                  var originalView = angular.copy($scope.view);\r\n                  $scope.view = 'redraw';\r\n                  $timeout(function () { //bit of a hacky way to redraw the calendar, should be refactored at some point\r\n                      $scope.view = originalView;\r\n                  });\r\n              });\r\n\r\n              //Remove the watcher when the calendar is destroyed\r\n              var unbindDestroyListener = $scope.$on('$destroy', function () {\r\n                  unbindDestroyListener();\r\n                  unbindWatcher();\r\n              });\r\n\r\n          }\r\n      };\r\n  });\r\n"],"sourceRoot":"/source/"}